---
title: "Find all elements matching phrase in svg from async profiler"
date: 2021-10-11T07:02:00+02:00
---

When you search for a phrase in a svg document generated by async
profiler it's often not so easy to find all places when 
it occurs. By default it changes
fill color but event though it might be problematic to
point all places if shares are 0.5% or 0.1%.

Below there is a helper function finding all svg elements
matching criteria and returning them with correesponding shares.

`g_to_func` and `find_child` are provided by a document
with svg generated by async profiler.

```js
function search_matches(search_phrase, ignorecase) {
    var re = new RegExp(search_phrase, ignorecase ? 'i' : '');
    var el = document.getElementById("frames").children;
    var matches = [];
    for (var i = 0; i < el.length; i++) {
        var e = el[i];
        var func = g_to_func(e);
        var rect = find_child(e, "rect");
        if (func == null || rect == null)
            continue;

        // get percent
        var perc = find_child(e, "title").textContent.split(' ')[3];

        if (func.match(re)) {
            matches.push([perc, rect]);
        }
    }
    return matches;
}
```